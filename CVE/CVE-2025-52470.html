<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CVE-2025-52470 – Stored XSS in Chamilo LMS</title>
  <style>
    body {
      background-color: black;
      color: white;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0 20px;
    }

    header {
      text-align: center;
      padding: 2rem 0;
    }

    h1 {
      font-size: 2.5em;
      margin-bottom: 0.5rem;
    }

    .tag {
      display: inline-block;
      background-color: #6e5494;
      color: white;
      font-size: 0.8em;
      padding: 4px 8px;
      border-radius: 4px;
      margin-bottom: 1rem;
    }

    article {
      max-width: 800px;
      margin: auto;
      line-height: 1.6;
    }

    h2 {
      color: #6e5494;
      margin-top: 2rem;
    }

    a {
      color: #6e5494;
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    pre {
      background-color: #1e1e1e;
      padding: 1rem;
      overflow-x: auto;
      border-radius: 6px;
      border: 1px solid #555;
    }

    code {
      font-family: monospace;
      color: #9cdcfe;
    }

    footer {
      text-align: center;
      margin-top: 3rem;
      font-size: 0.8em;
      color: white;
    }

    footer a {
      color: white;
    }

    footer a:hover {
      color: #6e5494;
    }
  </style>
</head>
<body>

<header>
  <h1>CVE-2025-52470</h1>
  <div class="tag">Stored XSS</div>
  <p><em>Persistent Cross-Site Scripting vulnerability in Chamilo LMS &le; 1.11.28</em></p>
</header>

<article>
  <h2>Overview</h2>
  <p>A stored cross-site scripting (XSS) vulnerability was discovered in Chamilo LMS versions up to 1.11.28. The issue allows an authenticated admin user to inject JavaScript via the "Session Category" feature, which gets executed in the context of other administrative users.</p>

  <h2>Affected Versions</h2>
  <ul>
    <li>Chamilo LMS &le; 1.11.28</li>
  </ul>

  <h2>Technical Details</h2>
  <p>The vulnerability is found in the file <code>session_category_add.php</code>, where user-supplied input for the <strong>Category Name</strong> is not properly sanitized before being stored in the database.</p>

  <p>This input is rendered unescaped in <code>add_many_sessions_to_category.php</code>, leading to persistent XSS execution when the page is visited by any other admin user.</p>

  <p>Steps to reproduce:</p>
  <pre><code>1. Login as an admin user.
2. Go to session_category_add.php.
3. Enter the following payload in the Category Name field:
   &lt;img/src/onerror=alert(2)&gt;
4. Submit the form.
5. Navigate to add_many_sessions_to_category.php.
6. The alert will trigger, demonstrating successful XSS.</code></pre>

  <h2>Impact</h2>
  <p>This stored XSS vulnerability allows a privileged attacker to:</p>
  <ul>
    <li>Inject persistent JavaScript code into the platform.</li>
    <li>Hijack sessions of other administrators.</li>
    <li>Steal sensitive information or perform actions in the context of another admin.</li>
    <li>Escalate internal attacks in environments with multiple trusted users.</li>
  </ul>

  <h2>Solution</h2>
  <ul>
    <li>Upgrade to <strong>Chamilo LMS 1.11.30</strong> or later.</li>
    <li>Direct patch: <a href="https://github.com/chamilo/chamilo-lms/commit/ead79db4eb034b8c11a3d6036759d083de37530c" target="_blank">GitHub Commit Fix</a>"https://github.com/chamilo/chamilo-lms/commit/ead79db4eb034b8c11a3d6036759d083de37530c"</li>
    <li>Ensure proper sanitization and escaping of user input before display.</li>
  </ul>

  <h2>Timeline</h2>
  <ul>
    <li>2025-05-16 – Vulnerability reported</li>
    <li>2025-06-17 – Patch committed</li>
    <li>2025-06-18 – CVE assigned (CVE-2025-52470)</li>
    <li>2025-07-01 – Securiy issue Release</li>

  </ul>

  <h2>References</h2>
  <ul>
    <li><a href="https://github.com/chamilo/chamilo-lms/commit/ead79db4eb034b8c11a3d6036759d083de37530c" target="_blank">Patch Commit on GitHub</a> "https://github.com/chamilo/chamilo-lms/commit/ead79db4eb034b8c11a3d6036759d083de37530c"</li>
    <li><a href="https://github.com/chamilo/chamilo-lms/wiki/security-issues#issue-201---2025-05-13---low-impact-low-risk---stored-cross-site-scripting-xss-via-session-category-cve-2025-52470">Chamilo security issues</a> https://github.com/chamilo/chamilo-lms/wiki/security-issues#issue-201---2025-05-13---low-impact-low-risk---stored-cross-site-scripting-xss-via-session-category-cve-2025-52470</li>
    <li><a href="https://archive.org/details/cve-2025-52470" target="_blank">Video PoC</a> "https://archive.org/details/cve-2025-52470"</li>
  </ul>
</article>

<footer>
  <p>
    &copy; 2025 <a href="https://github.com/NaklehZeidan21" target="_blank">Nakleh Zeidan</a>
  </p>
</footer>

</body>
</html>
